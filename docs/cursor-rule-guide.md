# Cursor è§„åˆ™é…ç½®æŒ‡å—

> æœ¬æŒ‡å—ä»‹ç»å¦‚ä½•åŸºäºé¡¹ç›®è‡ªåŠ¨ç”Ÿæˆ `.cursor/rule/fe-mcp.md`ï¼Œä»¥åŠå¦‚ä½•è‡ªå®šä¹‰è§„åˆ™ä»¥æå‡å‰ç«¯æµ‹è¯•ç”Ÿæˆæ•ˆæœã€‚

## ğŸ¯ ç›®æ ‡

- è§£é‡Š `cursor-rule-template.md` çš„ç»“æ„
- æŒ‡å¯¼å¦‚ä½•ä½¿ç”¨ `generate-cursor-rule` å·¥å…·å¿«é€Ÿç”Ÿæˆé…ç½®
- æä¾› Monorepo / å¤šé¡¹ç›®åœºæ™¯ä¸‹çš„æœ€ä½³å®è·µ
- å±•ç¤ºå¸¸è§è‡ªå®šä¹‰ç¤ºä¾‹

---

## ğŸ“ æ–‡ä»¶ç»“æ„

ç”Ÿæˆåçš„é…ç½®æ–‡ä»¶é»˜è®¤ä½äºï¼š

```
.c   /  (é¡¹ç›®æ ¹ç›®å½•)
â””â”€â”€ .cursor/
    â””â”€â”€ rule/
        â””â”€â”€ fe-mcp.md      # ç”± generate-cursor-rule ç”Ÿæˆ
```

> è‹¥ä¸å­˜åœ¨ `.cursor/rule` ç›®å½•ï¼Œå·¥å…·ä¼šè‡ªåŠ¨åˆ›å»ºã€‚

---

## ğŸ§© æ¨¡æ¿ä»‹ç»

`docs/cursor-rule-template.md` æä¾›äº†å®Œæ•´çš„å ä½ç¬¦æ¨¡æ¿ï¼Œæ¶µç›–ï¼š

- é¡¹ç›®ä¿¡æ¯ï¼ˆæŠ€æœ¯æ ˆã€Monorepo ç±»å‹ã€æµ‹è¯•æ¡†æ¶ï¼‰
- æµ‹è¯•ç­–ç•¥ï¼ˆæ¨èåœºæ™¯ã€æœ€å¤§æµ‹è¯•æ•°ã€å¢é‡ç­–ç•¥ï¼‰
- ä»£ç è§„èŒƒï¼ˆReactã€Mockã€æ–­è¨€åŸåˆ™ï¼‰
- Monorepo å»ºè®®ï¼ˆå­é¡¹ç›®ç‹¬ç«‹é…ç½®ã€å…±äº«è§„åˆ™ï¼‰
- å·²æœ‰æµ‹è¯•å¤„ç†ç­–ç•¥ï¼ˆä¿ç•™/è¦†ç›–/å¢é‡ï¼‰
- å…¶ä»–é¡¹ç›®ç‰¹å®šè§„åˆ™ï¼ˆçŠ¶æ€ç®¡ç†ã€APIã€UI ç­‰ï¼‰

æ¨¡æ¿ä¸­çš„å ä½ç¬¦ä¼šæ ¹æ®é¡¹ç›®å®é™…æƒ…å†µè¿›è¡Œæ›¿æ¢ï¼Œä¾‹å¦‚ï¼š

```
{{PROJECT_NAME}}        -> é¡¹ç›®åç§°
{{TEST_FRAMEWORK}}      -> vitest / jest / none
{{IS_MONOREPO}}         -> true / false
{{MONOREPO_TYPE}}       -> pnpm / yarn / npm / lerna / nx / rush
{{HAS_EXISTING_TESTS}}  -> true / false
```

---

## âš™ï¸ å¿«é€Ÿç”Ÿæˆé…ç½®

1. **åˆ›å»ºæˆ–è·å–å·¥ä½œåŒº**
   - è°ƒç”¨ `fetch-diff-from-repo` å·¥å…·ï¼Œè·å– `workspaceId`
   - æˆ–é€šè¿‡å…¶ä»–æ–¹å¼åˆ›å»ºå·¥ä½œåŒºï¼ˆä¾‹å¦‚è‡ªå®šä¹‰è„šæœ¬ï¼‰

2. **è°ƒç”¨ `generate-cursor-rule`**

```json
{
  "workspaceId": "ws-1731369700123-ab12cd",
  "outputPath": ".cursor/rule/fe-mcp.md"
}
```

- `outputPath` å¯é€‰ï¼Œé»˜è®¤å³ `.cursor/rule/fe-mcp.md`
- è¿”å›å€¼åŒ…å«ï¼š
  - `filePath`: ç”Ÿæˆæ–‡ä»¶çš„ç»å¯¹è·¯å¾„
  - `content`: å®é™…å†™å…¥çš„å†…å®¹ï¼ˆä¾¿äºåœ¨å·¥ä½œæµä¸­ç›´æ¥æŸ¥çœ‹ï¼‰

3. **éªŒè¯ç”Ÿæˆå†…å®¹**

- åœ¨ä»“åº“ä¸­æ£€æŸ¥ `.cursor/rule/fe-mcp.md`
- ç¡®ä¿ Monorepo å­é¡¹ç›®ï¼ˆå¦‚ `packages/ui-components`ï¼‰ä¹Ÿç”Ÿæˆäº†å¯¹åº”å†…å®¹ï¼ˆå¦‚æœ‰éœ€è¦ï¼‰

---

## ğŸ—ï¸ Monorepo æœ€ä½³å®è·µ

1. **æ ¹ç›®å½•æ”¾ç½®é€šç”¨è§„åˆ™**ï¼š
   - åŒ…å«å›¢é˜Ÿé€šç”¨çš„ç¼–ç è§„èŒƒã€æµ‹è¯•ç­–ç•¥
   - é€‚ç”¨äºæ‰€æœ‰å­é¡¹ç›®

2. **å­é¡¹ç›®è¦†ç›–è§„åˆ™**ï¼š
   - åœ¨ `apps/web/`ã€`packages/ui/` ç­‰å­ç›®å½•æ”¾ç½®ä¸“å± `fe-mcp.md`
   - `generate-cursor-rule` ä¼šæ ¹æ®å˜æ›´æ–‡ä»¶è‡ªåŠ¨æ£€æµ‹å¹¶ç”Ÿæˆå­é¡¹ç›®è§„åˆ™

3. **ç»“åˆ Monorepo æ£€æµ‹**ï¼š
   - `project-detector` ä¼šåˆ¤æ–­ `pnpm-workspace.yaml`ã€`lerna.json`ã€`nx.json` ç­‰æ–‡ä»¶
   - é€šè¿‡å·¥å…·è¾“å‡ºçš„ `projectConfig.packageRoot` å¯è·çŸ¥å®šä½åˆ°çš„å­é¡¹ç›®æ ¹ç›®å½•

---

## âœï¸ è‡ªå®šä¹‰è§„åˆ™ç¤ºä¾‹

### 1. React + Vitest é¡¹ç›®

```markdown
## æµ‹è¯•ç­–ç•¥
- å¿…é¡»è¦†ç›–æ­£å‘ï¼ˆhappy-pathï¼‰å’Œè¾¹ç•Œï¼ˆedge-caseï¼‰åœºæ™¯
- å¯é€‰è¦†ç›–é”™è¯¯åœºæ™¯ï¼ˆerror-pathï¼‰
- æ¨èä½¿ç”¨ `@testing-library/react`

## Mock è§„èŒƒ
- ä¼˜å…ˆä½¿ç”¨ `vi.mock`
- é¿å…åœ¨ç»„ä»¶å†…éƒ¨ç›´æ¥ mock DOM API

## æ–­è¨€é£æ ¼
- ä¼˜å…ˆä½¿ç”¨è¯­ä¹‰åŒ–æ–­è¨€ï¼ˆ`toBeInTheDocument`, `toHaveTextContent`ï¼‰
- é¿å…å¯¹å®ç°ç»†èŠ‚çš„æ–­è¨€ï¼ˆå¦‚å†…éƒ¨ stateï¼‰
```

### 2. API é›†æˆé¡¹ç›®

```markdown
## æµ‹è¯•ç­–ç•¥
- é’ˆå¯¹ API è°ƒç”¨æä¾›æˆåŠŸ/å¤±è´¥åœºæ™¯
- å¯¹ `fetch` / `axios` è°ƒç”¨è¿›è¡Œ Mock
- éœ€è¦éªŒè¯é”™è¯¯æç¤ºä¿¡æ¯

## Mock è§„èŒƒ
- ä½¿ç”¨ `msw` æˆ– `vi.spyOn(global, "fetch")`
- åœ¨æ¯ä¸ªæµ‹è¯•åæ¸…ç† Mockï¼ˆ`afterEach(() => vi.restoreAllMocks())`ï¼‰
```

### 3. Storybook ç»„ä»¶åº“

```markdown
## æµ‹è¯•ç­–ç•¥
- æ¯ä¸ªç»„ä»¶è‡³å°‘æä¾›ä¸€ä¸ªå¿«ç…§æµ‹è¯•
- å¯¹äº¤äº’ç»„ä»¶æä¾›ç”¨æˆ·äº¤äº’æµ‹è¯•ï¼ˆ`@testing-library/user-event`ï¼‰

## å‘½åçº¦å®š
- æµ‹è¯•æ–‡ä»¶å‘½åä¸º `ComponentName.test.tsx`
- ç»„ä»¶å¯¼å‡ºéœ€åŒ…å« `ComponentNameProps`
```

---

## ğŸ” å¸¸è§é—®é¢˜

1. **ç”Ÿæˆå†…å®¹ä¸ºç©ºï¼Ÿ**
   - æ£€æŸ¥ `workspaceId` æ˜¯å¦æœ‰æ•ˆ
   - ç¡®è®¤æ¨¡æ¿æ˜¯å¦å­˜åœ¨ (`docs/cursor-rule-template.md`)

2. **Monorepo æœªè¯†åˆ«ï¼Ÿ**
   - ç¡®è®¤ä»“åº“ä¸­å­˜åœ¨ pnpm/yarn workspaces æˆ–ç›¸å…³é…ç½®æ–‡ä»¶
   - æ£€æŸ¥ `projectConfig.isMonorepo` è¾“å‡ºæ˜¯å¦ä¸º `true`

3. **å¦‚ä½•è¦†ç›–æ¨¡æ¿ï¼Ÿ**
   - å¯å¤åˆ¶ `docs/cursor-rule-template.md` åˆ°é¡¹ç›®è‡ªå®šä¹‰è·¯å¾„
   - ä¿®æ”¹ `generate-cursor-rule` è¾“å…¥å‚æ•° `templatePath`ï¼ˆæœªæ¥ç‰ˆæœ¬é¢„ç•™ï¼‰

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [generate-cursor-rule å·¥å…·æºç ](../src/tools/generate-cursor-rule.ts)
- [cursor-rule-template.md](./cursor-rule-template.md)
- [project-detector å®ç°](../src/orchestrator/project-detector.ts)
- [workspace-manager å®ç°](../src/orchestrator/workspace-manager.ts)

---

é€šè¿‡åˆç†é…ç½® `.cursor/rule/fe-mcp.md`ï¼Œå¯ä»¥æ˜¾è‘—æå‡æµ‹è¯•ç”Ÿæˆçš„ä¸Šä¸‹æ–‡è´¨é‡å’Œä¸€è‡´æ€§ï¼Œä¸ºå›¢é˜Ÿå»ºç«‹ç»Ÿä¸€çš„å‰ç«¯æµ‹è¯•è§„èŒƒã€‚ç¥ä½¿ç”¨é¡ºåˆ©ï¼
